@model MVC_Team_Git_JooleMay_Service.Models.SearchModelS_Model

@using (Html.BeginForm("SearchBar", "Search", FormMethod.Post))
{
    @Html.HiddenFor(model => model.SubCategoryID)
    @Html.DropDownList("ddlCategories", Model.CategoriesList)
    @Html.TextBox("searchBox")
    //<input type="search" id="searchBox" style="width:250px" name="term" />
    //<input type="button" value="Search" class="btn btn-primary" onclick="location.href='@Url.Action("Search", "Search" )'" />
    <input type="submit" value="Search" class="btn btn-default" />
}

@section scripts{
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css" />
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>

    <script type="text/javascript">
        $(document).ajaxSuccess(function () {

            $("#searchBox").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "/Search/Autocomplete", type: "POST", dataType: "json",
                        data: {
                            term: request.term,
                            CategoryID: $("#ddlCategories").val(),
                            maxResults: 10
                        },
                        success: function (data) {
                            response($.map(data, function (item) {
                                return { label: item.SubCategoryName, value: item.SubCategoryName, id: item.SubCategoryID }
                            }))
                        }
                    })
                },
                select: function (event, ui) {
                    $("#SubCategoryID").val(ui.item.id);
                }
            });

        });
    </script>
}